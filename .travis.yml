dist: trusty
language: java
jdk:
  - openjdk8
  - openjdk9
  - openjdk10
  - openjdk11
before_install: if [ -e $JAVA_HOME/lib/security/cacerts ]; then ln -sf /etc/ssl/certs/java/cacerts $JAVA_HOME/lib/security/cacerts; fi
install: true
script: mvn -B -e -s .travis-settings.xml -Prelease -Dgpg.skip=true verify
before_cache: "find $HOME/.m2 -name '*-SNAPSHOT' -a -type d -print0 | xargs -0 rm -rf"
jobs:
  include:
    - if: repo = "veithen/daemon" AND branch = master AND type = push
      stage: deploy
      script: mvn -B -e -s .travis-settings.xml -Prelease -Dgpg.skip=true -DskipTests=true deploy
      env:
        - secure: "timDauyDta+69br2XVXmtApEVccJtyr5sbI4vFrxs7n2qlQtP3hd42l/ROXpsQU973cb5raHIpRiM3Lq3pqa+qpfA8Ysp4QPnziVAzSLiJ6uU77vif7V48s0DVkidnzjcvWsciX7VnMdnUA9moJzWfSlaTVMUUDjbQPYRoTYat+SoGQjqy71+cX9VXqYVbXSHAfuxISF7r+Bca+g6jzsJTdBnH/lRkDQAYFNpqqSj4z2vkvQB+CffecijKXmbDTUtalvmIn+EALPOYGtaCTgPhAJ1meznU/152nI6v9p0aGgsrKMRnJCcfP8JuNM1V649hidwyZQzaNMd3rTN61CytjgdaO2fAGz0ZoQH1I95LIyfLfP0KNefxIikQ+WxLHy/u5BaiBAMdYY5G2AcRoEsbwmdoDK6eoYmii5LAE4N3S8AFH70EUFmW4/e/UOE7IH8j5DTvwPgsHKc307FOPcngOInEDqy7F/AkJ61sDtmFldke+nA9l7zEOofR+V1wy/2hU0SCjXdRbOQLhSgBek7LW2yfTAo/KfdzIdzsifAi5NWRouzOy0nFzuFlbpdsMj0/kYiEEmp9yRmAjOuycFd+T9q1SZxpnl/j0CeFgElua1fJjsaSzhxukxLQNgLjjmD5bl4HfT+AaZAm8+ZA0NCT3f1MValAYsIR2WXisC7U0="
cache:
  directories:
    - $HOME/.m2
